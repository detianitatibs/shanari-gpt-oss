---
description: "CI品質チェック実装タスク一覧"
---

# Tasks: CI 品質チェック

**入力**: `/specs/002-ci-quality-check/` 内の設計書
**前提**: plan.md（必須）、spec.md（ユーザーストーリー取得に必須）

**テスト**: 以下のタスク例にテストタスクを含めます。テストは OPTIONAL で、仕様で明示的に要求されている場合のみ追加します。

**構成**: タスクはユーザーストーリーごとにグループ化して、各ストーリーを独立して実装・テストできるようにします。

## フォーマット: `[ID] [P?] [Story] 説明`

- **[P]**: 別ファイルで依存が無く、並列実行可能なタスク
- **[Story]**: ユーザーストーリー番号（例：US1, US2, US3）
- ファイルパスは必ず記載

## フェーズ 1: 基礎（必須前提）

**目的**: すべてのユーザーストーリーが実装可能になるまでに必要なインフラを整備

- [ ] T001 GitHub Actions のワークフローファイル `.github/workflows/ci.yml` を作成
- [ ] T002 [P] README.md に GitHub Actions Secrets 作成手順を追加
- [ ] T003 [P] Docker ビルドステップのテンプレートを作成
- [ ] T004 ワークフロー内に品質ゲートロジック（ジョブ失敗時に CI を失敗にする）を準備
- [ ] T005 `web/` 配下に Dockerfile を置き、ワークフローから参照できるようにする

## フェーズ 2: ユーザーストーリー 1 - コード品質を自動検証 (優先度 P1) 🎯 MVP

**ゴール**: コミット時に ESLint、Prettier、Vitest、Docker ビルドを自動実行し、結果を可視化

**独立テスト**: 変更をコミットし、feature ブランチへ push。CI が実行されすべてのジョブが成功することを確認

### 実装タスク

- [ ] T006 [P] [US1] GitHub Actions の `lint` ジョブを作成し、ESLint と Prettier を実行
- [ ] T007 [P] [US1] GitHub Actions の `test` ジョブを作成し、Vitest を実行してカバレッジを取得
- [ ] T008 [P] [US1] GitHub Actions の `docker-build` ジョブを作成し、`web/` で Docker イメージをビルド
- [ ] T009 [US1] `test` が `lint` に、`docker-build` が `test` に依存するようにジョブを構成
- [ ] T010 [US1] 最終 `report` ジョブを作成し、ログを集約して簡易 HTML レポートを artifact として保存

## フェーズ 3: ユーザーストーリー 2 - ブランチ統合時の品質ゲート (優先度 P2)

**ゴール**: Pull Request をマージできるのはすべての CI ジョブが成功した場合のみ

**独立テスト**: 故意にテストを失敗させた PR を作成し、マージがブロックされることを確認

### 実装タスク

- [ ] T011 [P] [US2] GitHub Actions のワークフローに PR 結果が失敗時にブロックするポリシーを追加

## フェーズ 4: ユーザーストーリー 3 - CI 結果の可視化とレポート共有 (優先度 P3)

**ゴール**: チーム全員が確認できる CI 結果レポートを提供

**独立テスト**: `report` ジョブの artifact をダウンロードし、ブラウザで表示できることを確認

### 実装タスク

- [ ] T012 [P] [US3] `report` ジョブを拡張し、GitHub Pages へ公開するか artifact として添付
- [ ] T013 [US3] `summary.md` のテンプレートを作成し、ジョブの成功/失敗情報をまとめる

## フェーズ N: ポリッシュと横断的課題

**目的**: 複数のストーリーに影響する改善を行う

- [ ] T014 [P] README.md を更新して CI の手順を追加
- [ ] T015 [P] workflow YAML を整形し、読みやすさを向上
- [ ] T016 [P] 追加ユニットテスト（ワークフロースクリプトがある場合）

## 依存関係と実行順序

**フェーズ依存**

- フェーズ 1: 依存なし（即実行可）
- フェーズ 2: フェーズ 1 完了後に実行
- フェーズ 3‑5: フェーズ 2 完了後に実行
- フェーズ N: フェーズ 3‑5 完了後に実行

**ストーリー依存**

- US1: フェーズ 2 後に開始可能、他ストーリーに依存なし
- US2: フェーズ 2 後に開始可能、US1 と統合は可だが独立してテスト可
- US3: フェーズ 2 後に開始可能、US1/US2 と統合は可だが独立してテスト可

**並列実行可能箇所**

- フェーズ 1 のすべてのタスクは [P] にマーク
- フェーズ 2 のすべてのタスクは [P] にマーク
- ストーリー間は並列で作業可能（チームリソースに応じて）
